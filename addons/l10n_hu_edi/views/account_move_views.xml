<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="account_move_form_inherit_l10n_hu_edi" model="ir.ui.view">
        <field name="name">account.move.form.inherit.l10n_hu_edi</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='id']" position="before">
                <field name="l10n_hu_edi_credentials_mode" invisible="1"/>
                <widget name="web_ribbon" title="Test mode" bg_color="bg-warning"
                        invisible="l10n_hu_edi_credentials_mode in [False, 'production']"/>
            </xpath>

            <!-- Documents tab -->
            <xpath expr="//page[@id='other_tab_entry']" position="after">
                <page id="l10n_hu_edi_transactions"
                      string="NAV 3.0"
                      invisible="not l10n_hu_edi_transaction_ids">
                    <field name="l10n_hu_edi_transaction_ids" readonly="l10n_hu_edi_credentials_mode == 'production'">
                        <tree create="false" edit="false"
                              decoration-danger="state in ['unsent', 'send_error', 'rejected']"
                              decoration-primary="state in ['to_send', 'token_error', 'sent', 'query_error']"
                              decoration-success="state == 'confirmed'"
                              decoration-warning="state in ['confirmed_warning', 'send_timeout']">

                            <field name="send_time"/>
                            <field name="state"/>
                            <field name="credentials_mode"/>
                            <field name="credentials_username"/>

                            <button name="action_download_file"
                                    type="object"
                                    string="Download invoice XML"/>
                            <button name="action_process"
                                    type="object"
                                    string="Process now"
                                    invisible="state not in ['to_send', 'token_error', 'sent', 'query_error']"/>
                            <button name="abort"
                                    type="object"
                                    string="Abort"
                                    invisible="state not in ['to_send', 'token_error']"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>
</odoo>